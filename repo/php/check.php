<?php

///////////////////////////////////////////////////////////////////////////////
//
// OPENTHEORY CHECK ENVIRONMENT
//
// Copyright (c) 2010 Joe Hurd, distributed under the GNU GPL version 2
//
///////////////////////////////////////////////////////////////////////////////

require_once 'directory.php';

///////////////////////////////////////////////////////////////////////////////
// Check the opentheory directory exists.
///////////////////////////////////////////////////////////////////////////////

if (!file_exists(DIRECTORY_PATH)) {
  $args = '';

  $output = opentheory('init',$args);

  if (isset($output)) {
    trigger_error('couldn\'t initialize directory: ' . $output);
  }
}

///////////////////////////////////////////////////////////////////////////////
// Check the package lists exist.
///////////////////////////////////////////////////////////////////////////////

if (!file_exists(site_path(array('packages','all.pkg')))) {
  $args = ' -o ' . site_path(array('packages','all.pkg'));

  $output = opentheory('list',$args);

  if (isset($output)) {
    trigger_error('couldn\'t regenerate package list: ' . $output);
  }
}

?>
